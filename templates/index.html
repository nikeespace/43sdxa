<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è´¦æˆ·ç®¡ç†ç³»ç»Ÿ</title>
    <style>
        :root {
            --bg-color: #f4f4f9;
            --text-color: #333;
            --container-bg: #ffffff;
            --input-bg: #ffffff;
            --border-color: #ddd;
        }

        [data-theme="dark"] {
            --bg-color: #121212;
            --text-color: #e0e0e0;
            --container-bg: #1e1e1e;
            --input-bg: #2d2d2d;
            --border-color: #444;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            transition: background-color 0.3s, color 0.3s;
            position: relative; /* ä¸ºäº†å³ä¸Šè§’å®šä½ */
        }

        /* å³ä¸Šè§’æ¨¡å¼åˆ‡æ¢æŒ‰é’® */
        .theme-switch-wrapper {
            position: absolute;
            top: 20px;
            right: 20px;
        }

        .theme-btn {
            background: none;
            border: 1px solid var(--text-color);
            color: var(--text-color);
            padding: 5px 10px;
            cursor: pointer;
            border-radius: 5px;
            font-size: 0.9em;
        }

        .container {
            background-color: var(--container-bg);
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 800px;
            transition: background-color 0.3s;
        }

        h2 { text-align: center; margin-bottom: 20px; }

        /* è¡¨å•æ ·å¼ */
        .form-group {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        input {
            flex: 1;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            background-color: var(--input-bg);
            color: var(--text-color);
        }

        button.add-btn {
            padding: 10px 20px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        button.add-btn:hover { background-color: #218838; }

        /* è¡¨æ ¼æ ·å¼ */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        .delete-btn {
            color: #dc3545;
            text-decoration: none;
            cursor: pointer;
            font-weight: bold;
        }

        .delete-btn:hover { text-decoration: underline; }

        /* å¼¹çª—æ ·å¼ (Modal) */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-box {
            background: var(--container-bg);
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            width: 300px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .modal-box input {
            width: 80%;
            margin: 15px 0;
            text-align: center;
        }

        .modal-buttons {
            display: flex;
            justify-content: space-around;
        }

        .btn-confirm { background-color: #007bff; color: white; padding: 5px 15px; border: none; border-radius: 4px; cursor: pointer; }
        .btn-cancel { background-color: #6c757d; color: white; padding: 5px 15px; border: none; border-radius: 4px; cursor: pointer; }
    </style>
</head>
<body>

    <div class="theme-switch-wrapper">
        <button class="theme-btn" onclick="toggleTheme()">â˜€ï¸/ğŸŒ™ æ¨¡å¼åˆ‡æ¢</button>
    </div>

    <div class="container">
        <h2>è´¦æˆ·ç®¡ç†é¢æ¿</h2>

        <form id="addForm" action="/add" method="POST" onsubmit="return false;">
            <div class="form-group">
                <input type="text" name="wallet_address" placeholder="Add (åœ°å€)" required>
                <input type="text" name="uid" placeholder="UID" required>
                <button type="button" class="add-btn" onclick="triggerAuth('add')">æ·»åŠ è´¦æˆ·</button>
            </div>
        </form>

        <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Add</th> <th>UID</th>
                    <th>æ“ä½œ</th>
                </tr>
            </thead>
            <tbody>
                {% for account in accounts %}
                <tr>
                    <td>{{ account[0] }}</td>
                    <td>{{ account[1] }}</td>
                    <td>{{ account[2] }}</td>
                    <td>
                        <span class="delete-btn" onclick="triggerAuth('delete', '{{ account[0] }}')">åˆ é™¤</span>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="modal-overlay" id="authModal">
        <div class="modal-box">
            <h3>å®‰å…¨éªŒè¯</h3>
            <p>è¯·è¾“å…¥æ“ä½œå¯†ç ï¼š</p>
            <input type="password" id="authPassword" placeholder="***" maxlength="10">
            <div class="modal-buttons">
                <button class="btn-cancel" onclick="closeModal()">å–æ¶ˆ</button>
                <button class="btn-confirm" onclick="confirmAction()">ç¡®è®¤</button>
            </div>
        </div>
    </div>

    <script>
        // --- 1. æ¨¡å¼åˆ‡æ¢é€»è¾‘ ---
        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute("data-theme");
            const newTheme = currentTheme === "dark" ? "light" : "dark";
            document.documentElement.setAttribute("data-theme", newTheme);
            localStorage.setItem("theme", newTheme);
        }

        // åˆå§‹åŒ–è¯»å–æœ¬åœ°å­˜å‚¨çš„ä¸»é¢˜
        const savedTheme = localStorage.getItem("theme") || "light";
        document.documentElement.setAttribute("data-theme", savedTheme);

        // --- 2. å®‰å…¨éªŒè¯é€»è¾‘ ---
        let pendingAction = null; // å­˜å‚¨å½“å‰ç­‰å¾…æ‰§è¡Œçš„æ“ä½œ
        let pendingId = null;     // å¦‚æœæ˜¯åˆ é™¤æ“ä½œï¼Œå­˜å‚¨ID

        const modal = document.getElementById('authModal');
        const passInput = document.getElementById('authPassword');
        const addForm = document.getElementById('addForm');

        // æ‰“å¼€éªŒè¯çª—å£
        function triggerAuth(action, id = null) {
            pendingAction = action;
            pendingId = id;
            passInput.value = ""; // æ¸…ç©ºè¾“å…¥æ¡†
            modal.style.display = 'flex';
            passInput.focus();
        }

        // å…³é—­éªŒè¯çª—å£
        function closeModal() {
            modal.style.display = 'none';
            pendingAction = null;
            pendingId = null;
        }

        // ç¡®è®¤å¯†ç 
        function confirmAction() {
            const password = passInput.value;

            if (password === "110") {
                // å¯†ç æ­£ç¡®ï¼Œæ‰§è¡Œæ“ä½œ
                if (pendingAction === 'add') {
                    addForm.submit(); // æäº¤è¡¨å•
                } else if (pendingAction === 'delete' && pendingId) {
                    window.location.href = `/delete/${pendingId}`; // è·³è½¬åˆ é™¤é“¾æ¥
                }
                closeModal();
            } else {
                alert("å¯†ç é”™è¯¯ï¼");
                passInput.value = "";
                passInput.focus();
            }
        }

        // æ”¯æŒå›è½¦é”®ç¡®è®¤
        passInput.addEventListener("keypress", function(event) {
            if (event.key === "Enter") {
                confirmAction();
            }
        });
    </script>
</body>
</html>
